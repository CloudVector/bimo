window.bimo=window.bimo||{},window.bimo.Bind=function(e){"use strict";var n,t,o,i,l,r,a,s,f,c,d,u=this,m={};e=e||{},"string"==typeof e.config&&(e.config={selector:e.config}),e.config=e.config||{},t=function(e,n,t){e.attachEvent?e.attachEvent("on"+n,t):e.addEventListener(n,t)},o=function(e,n){var t,o,i;if(u.options&&(e.options.length=0,u.placeHolder&&(t=document.createElement("option"),t.value="",t.label=u.placeHolder,void 0===n&&(t.selected="selected"),t.disabled="disabled",e.appendChild(t)),o="function"==typeof u.options?u.options.call(u):u.options)){if(Array.isArray(o)){for(var l={},r=0,a=o.length;a>r;r++)l[o[r]]=o[r];o=l}for(i in o)o.hasOwnProperty(i)&&(t=document.createElement("option"),t.value=i,t.label=o[i],i===n&&(t.selected="selected"),e.appendChild(t))}},i=function(e,n,t){e.detachEvent?e.detachEvent("on"+n,t):e.removeEventListener(n,t)},l=function(e,n){var t=function(e){n.call(u,e)};return m[e]=t,t},r=function(e){return void 0===e||null===e},a=function(e){return"[object Object]"===Object.prototype.toString.call(e)},s=function(e){var n;return null!==e&&(n=-1!==["SELECT","INPUT","TEXTAREA"].indexOf(e.nodeName)?e[u.property]:e.innerHTML),"function"==typeof u.write&&(n=u.write.call(u,n,e)),n},f=function(e,n){"function"==typeof u.read&&(n=u.read.call(u,n,e)),r(e)||r(n)||(-1!==["SELECT","INPUT","TEXTAREA"].indexOf(e.nodeName)?e[u.property]!==n&&(e[u.property]=n):e.innerHTML!==n&&(e.innerHTML=n))},c=function(e){if(u.twoWay){var n=s(e.target);void 0!==n&&(u.model[u.key]=n)}},d=function(e){var n,t,o;if(e._single===!0)if(null===u.elements)f(null,e.actual);else for(n=0,t=u.elements.length;t>n;++n)f(u.elements[n],e.actual);else for(o in e)if(e.hasOwnProperty(o)&&u.key===o)if(null===u.elements)f(null,e[o].actual);else for(n=0,t=u.elements.length;t>n;++n)f(u.elements[n],e[o].actual)},u.bind=function(e){var n,i,a;if(!r(u.elements))for(n=0,i=u.elements.length,n=0;i>n;++n){var s=u.elements[n];"SELECT"===s.nodeName?o(s,u.model[u.key]):"INPUT"===s.nodeName?f(s,u.model[u.key]):f(s,u.model[u.key])}if(u.model._watch(u.key,d),u.twoWay&&!r(u.elements))for(n=0,i=u.elements.length,n=0;i>n;++n)t(u.elements[n],u.event,c);for(a in u.events)if(u.events.hasOwnProperty(a)&&"function"==typeof u.events[a]){var m=l(a,u.events[a]);for(n=0,i=u.elements.length,n=0;i>n;++n)t(u.elements[n],a,m)}"function"==typeof e&&e.call(u)},u.unbind=function(e){var n,t,o;if(u.model._unwatch(u.key,d),u.twoWay)for(n=0,t=u.elements.length;t>n;++n)i(u.elements[n],u.event,c);for(o in m)if(m.hasOwnProperty(o))for(n=0,t=u.elements.length;t>n;++n)i(u.elements[n],o,m[o]);"function"==typeof e&&e.call(u)},Object.defineProperty(u,"visible",{enumerable:!0,configurable:!0,get:function(){var e=!0;return r(u.elements)||r(u.elements[0])||(e="none"!==u.elements[0].style.display),e},set:function(e){for(var n=0,t=u.elements.length;t>n;n++)u.elements[n].style.display=e?u.display||"":"none"}}),Object.defineProperty(u,"disabled",{enumerable:!0,configurable:!0,get:function(){var e=!1;return r(u.elements)||r(u.elements[0])||(e=u.elements[0].disabled),e},set:function(e){for(var n=0,t=u.elements.length;t>n;n++)u.elements[n].disabled=e}}),Object.defineProperty(u,"readOnly",{enumerable:!0,configurable:!0,get:function(){var e=!1;return r(u.elements)||r(u.elements[0])||-1===["INPUT","TEXTAREA"].indexOf(u.elements[0].nodeName)||(e=u.elements[0].readOnly),e},set:function(e){for(var n=0,t=u.elements.length;t>n;n++)-1!==["INPUT","TEXTAREA"].indexOf(u.elements[n].nodeName)&&(u.elements[n].readOnly=e)}}),Object.defineProperty(u,"required",{enumerable:!0,configurable:!0,get:function(){var e=!1;return r(u.elements)||r(u.elements[0])||(e=u.elements[0].required),e},set:function(e){for(var n=0,t=u.elements.length;t>n;n++)u.elements[n].required=e}});for(n in e)e.hasOwnProperty(n)&&"config"!==n&&(u[n]=e[n]);u.twoWay=void 0===u.twoWay?e.defaults.twoWay:u.twoWay,u.event=u.event||e.defaults.event,u.property=u.property||e.defaults.property,u.elements=e.config.elements||null,u.selector=e.config.selector||null;for(n in e.config)e.config.hasOwnProperty(n)&&(u[n]=e.config[n]);u.events=u.events||{},r(u.elements)&&(r(u.selector)?u.elements=null:u.elements=u.container.querySelectorAll(u.selector))},window.bimo.Binder=function(e){"use strict";var n=this;n.container=void 0===e.container?document:"string"==typeof e.container?document.querySelector(e.container):e.container,n.model=e.model||{},n.binds={},n.run=function(e){var t,o=function(n){"function"==typeof n[e]&&n[e].call(n)};for(t in n.binds)if(n.binds.hasOwnProperty(t))if(Array.isArray(n.binds[t]))for(var i=0,l=n.binds[t].length;l>i;i++)o(n.binds[t][i]);else o(n.binds[t])},n.init=function(e,t,o,i){var l;if(n.container=void 0===e?document:"string"==typeof e?document.querySelector(e):e,n.model=t,o){i=i||{twoWay:!0,event:"change",property:"value"};for(l in o)if(o.hasOwnProperty(l))if(Array.isArray(o[l])===!0){n.binds[l]=[];for(var r=0,a=o[l].length;a>r;r++){var s=new window.bimo.Bind({container:n.container,model:n.model,key:l,config:o[l][r],defaults:i});n.binds[l].push(s)}}else n.binds[l]=new window.bimo.Bind({container:n.container,model:n.model,key:l,config:o[l],defaults:i})}},n.bind=function(e){n.run("bind"),"function"==typeof e&&e.call(n)},n.unbind=function(e){n.run("unbind"),"function"==typeof e&&e.call(n)},e.model&&e.config&&n.init(n.container,n.model,e.config,e.defaults)};